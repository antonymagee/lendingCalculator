<!DOCTYPE html>  
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="AFSC Loan Calculator">
  <meta name="author" content="Antony Magee">
  <link rel="icon" href="afsc-favicon.ico">


<title>AFSC Loan Calculator</title>

</head>
<body>
<div class="container">

    <div class="row justify-content-md-center">

        <div class="col col-lg-2"></div>
        <div class="col-6 col-md-auto col-centered">
            <h3>
                Loan Payment Calculator
                <small id="para1" class="text-muted"></small>
            </h3>
            <hr>
            <form id="inputForm">
                <label for="loanAmount">Loan Amount</label>
                <div class="input-group">
                    <div class="input-group-addon" id=loan>$</div>
                    <input type="number" class="form-control validate" maxlength="7" id="loanAmount" placeholder="$10,000 minimum">
                </div>
                <label for="annualpayment">Interest</label>
                <div class="input-group">
                    <div class="input-group-addon">%</div>
                    <input class="form-control validate" id="inputInterest" maxlength="5">
                    <span class="input-group-btn">
                    <button onclick="window.open('https://www.afsc.ca/doc.aspx?id=1163')" class="btn btn-info" type="button">Get AFSC rates</button>
                 </span>
                </div>
                <label for="loanAmount">Amaturiation (Years)</label>
                <div id="sliderInput" class="input-group">
                    <input id="ex19" type="text" />
                </div>
                <div id="ex6SliderVal" class="hidden">1</div>
                <button class="btn btn-sm btn-info" id="reset" type="reset" value="Reset">Clear Form</button>
            </form>
            <hr>
            <div class="pad">
                <small class="text-muted ">*The calculator is for information purposes only.  Interest Rates are subject to change</small></div>

            <!-- 
    Beginning of Results Cards
  -->
<ul class="nav nav-tabs nav-fill" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" data-toggle="tab" href="#home" role="tab">Monthly</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" data-toggle="tab" href="#profile" role="tab">Quartely</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" data-toggle="tab" href="#messages" role="tab">Semi-Annnually</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" data-toggle="tab" href="#settings" role="tab">Annually</a>
  </li>
</ul>

<!-- Tab panes -->
<div class="tab-content">
<div class="tab-pane active" id="home" role="tabpanel">

    <div class="card-group">
        <div class="card">
            <div class="card-header">Monthly</div>
            <div class="card-block">
                <h4 class="card-title" id="tab1paymentMonthly"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Yearly</div>
            <div class="card-block">
                <h4 class="card-title" id="tab1yearlyPayment"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Total Payment</div>
            <div class="card-block">
                <h4 class="card-title" id="tab1total"></h4>
            </div>
        </div>
    </div>
    <div class="card-group">
        <div class="card">
            <div class="card-header">Total Interest</div>
            <div class="card-block">
                <h4 class="card-title" id="tab1totalInterest"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Principal first 12mo</div>
            <div class="card-block">
                <h4 class="card-title" id="tab1PrincipalFirst12"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Interest first 12mo</div>
            <div class="card-block">
                <h4 class="card-title" id="tab1InterestFirst12"></h4>
            </div>
        </div>
        <div class="card card-pad">
            <div class="card-header">Repayment Distribution</div>
            <div class="card-block" id="chartBlock">

                <canvas id="graph" width="400" height="250"></canvas>
            </div>
            </div>

    </div>
</div>
<div class="tab-pane" id="profile" role="tabpanel">
    <div class="card-group">
        <div class="card">
            <div class="card-header">Quartely </div>
            <div class="card-block">
                <h4 class="card-title" id="tab2Quarterly"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Yearly</div>
            <div class="card-block">
                <h4 class="card-title" id="tab2Yearly"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Total Payment</div>
            <div class="card-block">
                <h4 class="card-title" id="tab2Total"></h4>
            </div>
        </div>
    </div>
    <div class="card-group">
        <div class="card">
            <div class="card-header">Total Interest</div>
            <div class="card-block">
                <h4 class="card-title" id="tab2TotalInterest"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Principal first 12mo</div>
            <div class="card-block">
                <h4 class="card-title" id="tab2PrincipalFirst12"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Interest first 12mo</div>
            <div class="card-block">
                <h4 class="card-title" id="tab2InterestFirst12"></h4>
            </div>
        </div>
        <div class="card card-pad">
            <div class="card-header">Repayment Distribution</div>
            <div class="card-block" id="chartBlock">

                <canvas id="graph" width="400" height="250"></canvas>
            </div>
            </div>
    </div>

</div>
<div class="tab-pane" id="messages" role="tabpanel">
    <div class="card-group">
        <div class="card">
            <div class="card-header">Semi-Annually </div>
            <div class="card-block">
                <h4 class="card-title" id="tab3SemiAnnually"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Yearly</div>
            <div class="card-block">
                <h4 class="card-title" id="tab3Yearly"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Total Payment</div>
            <div class="card-block">
                <h4 class="card-title" id="tab3Total"></h4>
            </div>
        </div>
    </div>
    <div class="card-group">
        <div class="card">
            <div class="card-header">Total Interest</div>
            <div class="card-block">
                <h4 class="card-title" id="tab3TotalInterest"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Principal first 12mo</div>
            <div class="card-block">
                <h4 class="card-title" id="tab3PrincipalFirst12"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Interest first 12mo</div>
            <div class="card-block">
                <h4 class="card-title" id="tab3InterestFirst12"></h4>
            </div>
        </div>
        <div class="card card-pad">
            <div class="card-header">Repayment Distribution</div>
            <div class="card-block" id="chartBlock">

                <canvas id="graph" width="400" height="250"></canvas>
            </div>
            </div>
    </div>

</div>
<div class="tab-pane" id="settings" role="tabpanel">
    <div class="card-group">
        <div class="card">
            <div class="card-header">Annually</div>
            <div class="card-block">
                <h4 class="card-title" id="tab4Annually"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Yearly</div>
            <div class="card-block">
                <h4 class="card-title" id="tab4Yearly"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Total Payment</div>
            <div class="card-block">
                <h4 class="card-title" id="tab4Total"></h4>
            </div>
        </div>
    </div>
    <div class="card-group">
        <div class="card">
            <div class="card-header">Total Interest</div>
            <div class="card-block">
                <h4 class="card-title" id="tab4TotalInterest"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Principal first 12mo</div>
            <div class="card-block">
                <h4 class="card-title" id="tab4PrincipalFirst12"></h4>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Interest first 12mo</div>
            <div class="card-block">
                <h4 class="card-title" id="tab4InterestFirst12"></h4>
            </div>
        </div>
        <div class="card card-pad">
            <div class="card-header">Repayment Distribution</div>
            <div class="card-block" id="chartBlock">

                <canvas id="graph" width="400" height="250"></canvas>
            </div>
            </div>

    </div>
</div>

            
                </div>
                
            
        </div>
        <div class="col  col-lg-2"></div>
        </div>



        




        <!-- End of Central Coloumn -->

    </div>
    <!-- End of Central Coloumn -->
</div>

<!-- End of Container -->
</div>

<!-- End of HTML  -->
    <script src="https://npmcdn.com/tether@1.2.4/dist/js/tether.min.js"></script>
    <script src="js/jquery-ui.min.js"> </script>
    <script src="js/jquery-3.2.0.min.js"> </script>
    <script src="js/Chart.min.js"> </script>
    <script src="js/Bootstrap.js"> </script>
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/bootstrap-slider.css" rel="stylesheet">
    <link href="css/bootstrap-slider.css" rel="stylesheet">

    

    
    <script src="js/bootstrap-slider.js"></script>
    <script src="http://afarkas.github.io/webshim/js-webshim/minified/polyfiller.js"></script>

<script>

$(document).ready(function () {

// Creates the Chart, with the desired values 
var realValues = [0, 1, 3, 5, 10, 20];

 $('#ex19').bootstrapSlider({
    value: 0,
    max: 4,
    min: 0,
    step: 1,
    ticks: [1, 2, 3, 4, 5],
    ticks_labels: ["1", "3", "5", "10", "20"],

  })
  .on('change', function(data){
     $("#ex6SliderVal").text(realValues[data.value.newValue])
     calculate()
  });
    
    
// This block attatches listeners to the input fields to make sure any changes 
// spark the calculate method to always update the total.
// also calls the caculate() function to update the total displayed numbers      
$("#ex19").on("slideStop", function(){

    calculate()
});


$("#ex19").on("slide", function(){

    calculate()
});

$("#loanAmount").keyup(function() {
    
    calculate()
}); 

$("#inputInterest").keyup(function() {
    
    calculate()
});  

// ----------------------------------------------------------------------


// Reset button, removes the Div's for the slider and chart and seeds with a blank container
$("#reset").click(function() {
    

    $("#sliderInput").html("<input id='ex19' type='text'>");
    $("#chartBlock").html(" <canvas id='graph' width='400' height='250'></canvas>");


    $('#ex19').bootstrapSlider({
    value: 0,
    max: 4,
    min: 0,
    step: 1,
    ticks: [1, 2, 3, 4, 5],
    ticks_labels: ["1", "3", "5", "10", "20"],

  })
  .on('change', function(data){
     $("#ex6SliderVal").text(realValues[data.value.newValue])
     calculate()
  });

// Start with all the results boxes initialized as blank  

    $("#tab1paymentMonthly").empty();
    $("#tab1yearlyPayment").empty();
    $("#tab1total").empty();
    $("#tab1totalInterest").empty();
    $("#tab1PrincipalFirst12").empty();
    $("#tab1InterestFirst12").empty();

    $("#tab2Quarterly").empty();
    $("#tab2Yearly").empty();
    $("#tab2Total").empty();
    $("#tab2TotalInterest").empty();
    $("#tab2PrincipalFirst12").empty();
    $("#tab2InterestFirst12").empty();

    $("#tab3SemiAnnually").empty();
    $("#tab3Yearly").empty();
    $("#tab3Total").empty();
    $("#tab3TotalInterest").empty();
    $("#tab3PrincipalFirst12").empty();
    $("#tab3InterestFirst12").empty();

    $("#tab4Annually").empty();
    $("#tab4Yearly").empty();
    $("#tab4Total").empty();
    $("#tab4TotalInterest").empty();
    $("#tab4PrincipalFirst12").empty();
    $("#tab4InterestFirst12").empty();

    
}); 

// Adds styling for the currency to be displayed in the LoanAmount input.
webshims.setOptions('forms-ext', {
    replaceUI: 'auto',
    types: 'number'
});
webshims.polyfill('forms forms-ext');


// Draws the chart with the calues passed in.
function chartjs(principal, payments, justInterest){
     // payments is the loan term in months - change to years
     var paymentYears = payments / 12
     // full loan + interest amount divided by term
     var chartTotalpayment = (principal + justInterest) / paymentYears
     // find the principal per year
     var yearlyPrincipal = principal / paymentYears
     var yearlyInterest = justInterest / paymentYears


        if (paymentYears == 1){
            var timeLine = ["0", "1"];
            var totalLine = ["0", chartTotalpayment];
            var principleLine = [ "0", 
                                    principal ];
        } else if (paymentYears == 3){
            var timeLine = ["0","1", "2", "3"];
            var totalLine = ["0",
                            chartTotalpayment, 
                            chartTotalpayment * 2,
                            chartTotalpayment * 3];
            var principleLine = ["0",
                                principal - (yearlyPrincipal*2),
                                principal - (yearlyPrincipal),
                                principal
                                ];              
        } else if (paymentYears == 5){
            var timeLine = ["0", "1", "2", "3", "4", "5"];
            var totalLine = ["0",
                            chartTotalpayment, 
                            chartTotalpayment * 2,
                            chartTotalpayment * 3,
                            chartTotalpayment * 4,
                            chartTotalpayment * 5];
            var principleLine = ["0",
                                principal - (yearlyPrincipal*4),
                                principal - (yearlyPrincipal*3),
                                principal - (yearlyPrincipal*2),
                                principal - (yearlyPrincipal),
                                principal,                    
                                ];                
        } else if (paymentYears == 10){
            var timeLine = ["0","1", "2", "3", "4", "5", "6", "7", "8", "9", "10"];
            var totalLine = ["0",
                            chartTotalpayment, 
                            chartTotalpayment * 2,
                            chartTotalpayment * 3,
                            chartTotalpayment * 4,
                            chartTotalpayment * 5,
                            chartTotalpayment * 6,
                            chartTotalpayment * 7,
                            chartTotalpayment * 8,
                            chartTotalpayment * 9,
                            chartTotalpayment * 10];
            var principleLine = ["0",
                                principal - (yearlyPrincipal*9),
                                principal - (yearlyPrincipal*8),
                                principal - (yearlyPrincipal*7),
                                principal - (yearlyPrincipal*6),
                                principal - (yearlyPrincipal*5),
                                principal - (yearlyPrincipal*4),
                                principal - (yearlyPrincipal*3),
                                principal - (yearlyPrincipal*2),
                                principal - (yearlyPrincipal),
                                principal,                    
                                ];                 
        } else if (paymentYears == 20){
            var timeLine = ["0" ,"1", "5", "10", "15", "20"];
            var totalLine = ["0",
                            chartTotalpayment , 
                            chartTotalpayment * 5,
                            chartTotalpayment * 10,
                            chartTotalpayment * 15,
                            chartTotalpayment * 20];
            var principleLine = ["0",
                                principal - (yearlyPrincipal*19),
                                principal - (yearlyPrincipal*15),
                                principal - (yearlyPrincipal*10),
                                principal - (yearlyPrincipal*5),
                                principal,                    
                                ];                 
        }


    var ctx = document.getElementById('graph').getContext('2d');
    var myChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: timeLine,
            datasets: [{
                label: 'Principal + Interest',
                    data: totalLine,
                    backgroundColor: "rgba(174, 230, 173, 0.4)",
                    strokeColor: "rgba(220,220,220,1)",
                    pointColor: "rgba(220,220,220,1)",
                    pointStrokeColor: "#fff",
                    pointHighlightFill: "#fff",
                    pointHighlightStroke: "rgba(220,220,220,1)"
                }, {
                label: 'Principal',
                    data: principleLine,
                    backgroundColor: "rgba(132, 189, 225, 0.8)",
                    strokeColor: "rgba(151,187,205,1)",
                    pointColor: "rgba(151,187,205,1)",
                    pointStrokeColor: "#fff",
                    pointHighlightFill: "#fff",
                    pointHighlightStroke: "rgba(151,187,205,1)"
                        
                }]
    }
    });

}


function calculate() {

    // Look up the input and output elements in the document
    // Loan Amount
    var amount = document.getElementById("loanAmount");
    // Interest Rate
    var interest = document.getElementById("inputInterest");
    // Slider value 
    var years = parseFloat(document.getElementById("ex6SliderVal").childNodes[0].nodeValue);
    // Takes loan amount input and changes it to an float
    var principal = parseFloat(amount.value);
    // Takes Interest input and changes to float with 3 decimal places
    var inputInterest = parseFloat(interest.value).toFixed(3) /100;
    // Takes the number of years to amaturize and converts to months
    var payments = years *12;
    
    
    calculateMonthly(principal, inputInterest, years, payments);
    calculateQuarterly(principal, inputInterest, years, payments);
    calculateSemiAnnually(principal, inputInterest, years, payments);
    calculateAnnually(principal, inputInterest, years, payments);

}

function calculateMonthly(principal, inputInterest, years, payments) {
    // Sets the payment frequency per year to 12
    var paymentFreqPerYear = 12;
    // Set the time a year the loan compounds = Anually 
    var compounding = 1;
    // Derived from the effective interest rate provided by Bryant
    var effectiveInterest = Math.pow((1 + (inputInterest / compounding)), (compounding / paymentFreqPerYear) )-1;
    // Calculation of the payment
    var envoy = (principal * (effectiveInterest / ( 1- ( 1 / Math.pow(( 1 + effectiveInterest), paymentFreqPerYear * (payments / 12)))))).toFixed(2);

    var cumulativeInterest = parseFloat(((envoy * paymentFreqPerYear)* years )-principal);

    var remaining = principal;



    // If the result is a finite number, the user's input was good and
    // we have meaningful results to display
    if (isFinite(envoy)) {
        // Fill in the output fields, rounding to 2 decimal places
       
        tab1yearlyPayment.innerHTML = "$" + (envoy * 12).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab1paymentMonthly.innerHTML = "$" + envoy.replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab1total.innerHTML = "$" + (envoy * payments).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab1totalInterest.innerHTML = "$" + cumulativeInterest.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');

        var oldBalance=principal;
        var newBalance=principal;
        var intRate = inputInterest / 12;
        var monthly = envoy;
        var owedInterest = 0;
        var totalInterestPd = 0;
        var totalPrincipalPd = 0;
        var numPay = 12;

        for(var i=1;i<=numPay;i++) {
            var loopNum=i;
            owedInterest=newBalance*intRate;
            var dispInt=owedInterest;
            totalInterestPd += owedInterest;


            // Test for the final payment
            if (i <= numPay) {
            monthly=envoy-dispInt;
            totalPrincipalPd += monthly;
            oldBalance=newBalance;
            newBalance=oldBalance-monthly;
            }
            else {
            monthly=(oldBalance-monthly)+owedInterest;
            oldBalance=newBalance;
            newBalance=0;
            monthly=monthly;
            }
        }// end of For
 
        tab1PrincipalFirst12.innerHTML = "$" + totalPrincipalPd.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab1InterestFirst12.innerHTML = "$" + totalInterestPd.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');

        /*tab1PrincipalFirst12.innerHTML = "$" + (principal -(principal * effectiveInterest)).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');

        tab1InterestFirst12.innerHTML = "$" + ((principal) * effectiveInterest).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');*/

        // Draw Chart
        //chartjs(principal, payments, cumulativeInterest);
    }
    else {  
        // Result was Not-a-Number or infinite, which means the input was
        // incomplete or invalid. Clear any previously displayed output.
     
        tab1paymentMonthly.innerHTML = "";        // Erase the content of these elements
        tab1total.innerHTML = ""
        tab1totalInterest.innerHTML = "";
        tab1yearlyPayment.innerHTML = "";
        tab1PrincipalFirst12.innerHTML = "";
        tab1InterestFirst12.innerHTML = "";
    
    }

}

function calculateQuarterly(principal, inputInterest, years, payments) {
     // Sets the payment frequency per year to 12
    var paymentFreqPerYear = 4;

    // Set the time a year the loan compounds = Anually 
    var compounding = 1;

    // Derived from the effective interest rate provided by Bryant
    var effectiveInterest = Math.pow((1 + (inputInterest / compounding)), (compounding / paymentFreqPerYear) )-1;
    // Calculation of the payment
    var envoy = principal * (effectiveInterest / ( 1- ( 1 / Math.pow(( 1 + effectiveInterest), paymentFreqPerYear * (payments / 12)))));

    var cumulativeInterest = parseFloat(((envoy* paymentFreqPerYear)* years)-principal);

    // If the result is a finite number, the user's input was good and
    // we have meaningful results to display
    if (isFinite(envoy)) {

        tab2Yearly.innerHTML = "$" + (envoy * 4).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab2Quarterly.innerHTML = "$" + envoy.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab2Total.innerHTML = "$" + ((envoy * paymentFreqPerYear) * years).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab2TotalInterest.innerHTML = "$" + cumulativeInterest.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');

        var oldBalance=principal;
        var newBalance=principal;
        var intRate = inputInterest / 4;
        var monthly = envoy;
        var owedInterest = 0;
        var totalInterestPd = 0;
        var totalPrincipalPd = 0;
        var numPay = 4;

        for(var i=1;i<=numPay;i++) {
            var loopNum=i;
            owedInterest=newBalance*intRate;
            var dispInt=owedInterest;
            totalInterestPd += owedInterest;


            // Test for the final payment
            if (i <= numPay) {
            monthly=envoy-dispInt;
            totalPrincipalPd += monthly;
            oldBalance=newBalance;
            newBalance=oldBalance-monthly;
            }
            else {
            monthly=(oldBalance-monthly)+owedInterest;
            oldBalance=newBalance;
            newBalance=0;
            monthly=monthly;
            }
        }// end of For

        tab2PrincipalFirst12.innerHTML = "$" + totalPrincipalPd.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab2InterestFirst12.innerHTML = "$" + totalInterestPd.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');

    }
    else {  
        // Result was Not-a-Number or infinite, which means the input was
        // incomplete or invalid. Clear any previously displayed output.
     
        tab2Quarterly.innerHTML = "";        // Erase the content of these elements
        tab2Total.innerHTML = ""
        tab2TotalInterest.innerHTML = "";
        tab2Yearly.innerHTML = "";
        tab2PrincipalFirst12.innerHTML = "";
        tab2InterestFirst12.innerHTML = "";
    
    }
}

function calculateSemiAnnually(principal, inputInterest, years, payments) {

    // Sets the payment frequency per year to 12
    var paymentFreqPerYear = 2;

    // Set the time a year the loan compounds = Anually 
    var compounding = 1;

    // Derived from the effective interest rate provided by Bryant
    var effectiveInterest = Math.pow((1 + (inputInterest / compounding)), (compounding / paymentFreqPerYear) )-1;
    // Calculation of the payment
    var envoy = principal * (effectiveInterest / ( 1- ( 1 / Math.pow(( 1 + effectiveInterest), paymentFreqPerYear * (payments / 12)))));

    var cumulativeInterest = parseFloat(((envoy* paymentFreqPerYear)* years)-principal);

    // If the result is a finite number, the user's input was good and
    // we have meaningful results to display
    if (isFinite(envoy)) {

        tab3Yearly.innerHTML = "$" + (envoy * 2).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab3SemiAnnually.innerHTML = "$" + envoy.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab3Total.innerHTML = "$" + ((envoy * paymentFreqPerYear) * years).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab3TotalInterest.innerHTML = "$" + cumulativeInterest.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');

        var oldBalance=principal;
        var newBalance=principal;
        var intRate = inputInterest / 2;
        var monthly = envoy;
        var owedInterest = 0;
        var totalInterestPd = 0;
        var totalPrincipalPd = 0;
        var numPay = 2;

        for(var i=1;i<=numPay;i++) {
            var loopNum=i;
            owedInterest=newBalance*intRate;
            var dispInt=owedInterest;
            totalInterestPd += owedInterest;


            // Test for the final payment
            if (i <= numPay) {
            monthly=envoy-dispInt;
            totalPrincipalPd += monthly;
            oldBalance=newBalance;
            newBalance=oldBalance-monthly;
            }
            else {
            monthly=(oldBalance-monthly)+owedInterest;
            oldBalance=newBalance;
            newBalance=0;
            monthly=monthly;
            }
        }// end of For
 
        tab3PrincipalFirst12.innerHTML = "$" + totalPrincipalPd.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab3InterestFirst12.innerHTML = "$" + totalInterestPd.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');

    }
    else {  
        // Result was Not-a-Number or infinite, which means the input was
        // incomplete or invalid. Clear any previously displayed output.
     
        tab3SemiAnnually.innerHTML = "";        // Erase the content of these elements
        tab3Total.innerHTML = ""
        tab3TotalInterest.innerHTML = "";
        tab3Yearly.innerHTML = "";
        tab3PrincipalFirst12.innerHTML = "";
        tab3InterestFirst12.innerHTML = "";
    
    }

}

function calculateAnnually(principal, inputInterest, years, payments) {

    // Sets the payment frequency per year to 12
    var paymentFreqPerYear = 1;

    // Set the time a year the loan compounds = Anually 
    var compounding = 1;

    // Derived from the effective interest rate provided by Bryant
    var effectiveInterest = Math.pow((1 + (inputInterest / compounding)), (compounding / paymentFreqPerYear) )-1;
    // Calculation of the payment
    var envoy = principal * (effectiveInterest / ( 1- ( 1 / Math.pow(( 1 + effectiveInterest), paymentFreqPerYear * (payments / 12)))));

    var cumulativeInterest = parseFloat(((envoy* paymentFreqPerYear)* years)-principal);

    // If the result is a finite number, the user's input was good and
    // we have meaningful results to display
    if (isFinite(envoy)) {

        tab4Yearly.innerHTML = "$" + (envoy).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab4Annually.innerHTML = "$" + envoy.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab4Total.innerHTML = "$" + ((envoy * paymentFreqPerYear) * years).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        tab4TotalInterest.innerHTML = "$" + cumulativeInterest.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        
        tab4PrincipalFirst12.innerHTML = "$" + (principal -(principal * effectiveInterest)).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
        
        tab4InterestFirst12.innerHTML = "$" + ((principal) * effectiveInterest).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');

    }
    else {  
        // Result was Not-a-Number or infinite, which means the input was
        // incomplete or invalid. Clear any previously displayed output.
     
        tab4Annually.innerHTML = "";        // Erase the content of these elements
        tab4Total.innerHTML = ""
        tab4TotalInterest.innerHTML = "";
        tab4Yearly.innerHTML = "";
        tab4PrincipalFirst12.innerHTML = "";
        tab4InterestFirst12.innerHTML = "";
    
    }

}



// Select your input element.
var number = document.getElementById('loanAmount', 'inputInterest');

// Listen for input event on numInput. This block filters out keystrokes not from the 
// num pad or the upper numbers keys
number.onkeydown = function(e) {
    if(!((e.keyCode > 95 && e.keyCode < 106)
      || (e.keyCode > 47 && e.keyCode < 58) 
      || e.keyCode == 8)) {
        return false;
    }
}

// caculates the date for the top of the page
document.getElementById("para1").innerHTML = formatAMPM();

function formatAMPM() {
      var d = new Date(),
        months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
      return d.getDate() + ' ' + months[d.getMonth()] + ' ' + d.getFullYear();
    }

// end of $ function
});

</script>

</body>
</html>
